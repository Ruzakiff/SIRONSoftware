<!-- _includes/gif_timer.html -->
<button id="startDemo" class="download-button">Start Demo</button>
<img id="demoGif" src="{{ include.baseurl }}/assets/images/ecmsdemo.gif" style="display:none;" />
<div id="timer" style="font-weight: bold;"></div>

<script>
var demoRunning = false; // Flag to check if the demo is already running

function startDemo() {
    if (demoRunning) return; // If demo is already running, do nothing
    demoRunning = true; // Set the flag to true as the demo starts

    var gif = document.getElementById('demoGif');
    var timerElement = document.getElementById('timer');
    var duration = 28; // Duration of the GIF in seconds
    gif.style.display = 'block'; // Show the GIF
    gif.src = gif.src + '?' + new Date().getTime(); // Restart the GIF by forcing a reload

    gif.onload = function() {
        timerElement.innerHTML = 'Demo duration: ' + duration + ' seconds';

        var countdown = duration;
        var timer = setInterval(function() {
            countdown--;
            timerElement.innerHTML = 'Time elapsed: ' + (duration - countdown) + ' seconds. Time left: ' + countdown + ' seconds';
            if (countdown <= 0) {
                clearInterval(timer);
                timerElement.innerHTML = 'Demo ended';
                gif.style.display = 'none'; // Optionally hide the GIF after playing
                demoRunning = false; // Reset the flag as the demo ends
            }
        }, 1000);
    };
}

document.getElementById('startDemo').addEventListener('click', startDemo);
</script>
